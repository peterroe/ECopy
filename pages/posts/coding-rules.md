---
title: 理解不同的编码规则
date: 2022-01-22
duration: 5min
---

[[toc]]

首先我们需要知道为什么需要编码？

计算机处理的数据实际上都是二进制数据，那么想要把这些数据转化为我们日常只用的语言文字，必然需要一套规则进行**解码转换**，同样的，我们将语言文字转化为二进制也需要这样的规则

## ASCII

`ASCII`是编码的始祖，由美国人发明，使用**单字节编码**，可以表示`2 ** 8 = 256`个字符，实际使用的只有`128`个

英语只有`26个`字母，加上其他一些日常使用的符号，所以这种编码方式早期对于美国人或者以英语为母语的国家来说足够使用了，如下是所有的`ASCII`编码：

<img src="https://pic2.zhimg.com/80/ae3da0a3ad540a9439f8e917a2842b69_1440w.jpg?source=1940ef5c" />

单字节的表示范围:

```shell
0-127
```

## GB2312

`GB2312`是`ASCII`的中文扩展，兼容ASCII的同时，可以编码数千个中文字符（约`7000`）

`GB2312`使用固定双字节表示，为了节省磁盘，单字节表示`ASCII`码，双字节表示汉字

在这两个字节中，如果最高位都是`1`，就是汉字，如果是`0`，就是`ASCII`码。很好理解，如果遇到字节最高位是`1`，那么继续读取下一个字节，两个字节组成一个中文字；如果遇到的字节最高位是`0`，那么就用`ASCII`码规则解析

双字节的表示范围:

```shell
161-247 | 161-254
```

## GBK

`GBK`是`GB2312`的扩展(KuoZhan)，在于解决稀有文字和繁体的编码，增加了一万四千多个汉字，共计`21000`左右

双字节的表示范围:

```shell
129-254 | 64-126 128-254
```

## GB18030

`GB18030`是`GBK`的扩展，在于解决少数名族的文字编码以及统一中日韩字符，共计`76000`多个字符

字符集的数量以及超过了`65536`，两个字节以及容纳不下了，所以`GB18030`使用变长编码，有的是双字节，有的是四字节

四个字节的表示范围:

```shell
129-254 | 48-57 | 129-254 | 48-57
```

> 综上看来，兼容性 GB18030 > GBK > GB2312 > ASCII

## Big5

台湾自创的一套编码规则，包含约`13000`个繁体字，和`GB2313类似`使用双字节编码

```shell
129-254 | 64-126 161-254
```

根据编码范围来看，`Big5`是无法和`GB`的三个编码兼容的

## Unicode

狭义上的`Unicode`指的是一个字符集，并不是编码方式，在计算机领域，它是一种标准，得以体现实际上所有文字的系统

`Unicode`最早使用双字节编码，即可以表示`65536`个字符。现在已经扩展为四字节

## UTF-8

`unicode`在很长一段时间内无法推广，直到互联网的出现，为解决`unicode`如何在网络上传输的问题，于是面向传输的众多 `UTF（UCS Transfer Format）`标准出现了

`UTF-8`是对`Unicode`的可变长度字符编码，对于单字节的编码，字节的第一位设置为`0`，对于英语文本，`UTF-8`只占用一个字节，对于`n`个字节的字符，可通过如下方式来辨认：

```shell
0xxxxxxx # 为ASCILL保留
110xxxxx 10xxxxxx # 开头两个1代表这个字符是2个字节
1110xxxx 10xxxxxx 10xxxxxx # 开头三个1代表这个字符是3个字节
11110xxx 10xxxxxx 10xxxxxx 10xxxxxx # 同理
```

如上的编码方式也极大的节省了空间，除此之外，要注意`Unicode`编码的中文字符占两个字节，而`UTF-8`编码的占三个字节，所以`Unicode`到`UFT-8`不是直接的对应，而是存在转换关系

<img src="https://pica.zhimg.com/80/v2-121a14291638f0b28e1dde7c95d2d379_1440w.jpg?source=1940ef5c" />

根据上表，解读 `UTF-8` 编码非常简单。如果一个字节的第一位是`0`，则这个字节单独就是一个字符；如果第一位是`1`，则连续有多少个`1`，就表示当前字符占用多少个字节。下面，还是以汉字严为例，演示如何实现 `UTF-8` 编码。严的 `Unicode` 是`4E25（100111000100101）`，根据上表，可以发现`4E25`处在第三行的范围内`（0000 0800 - 0000 FFFF）`，因此严的 `UTF-8` 编码需要三个字节，即格式是`1110xxxx 10xxxxxx 10xxxxxx`。然后，从严的最右边二进制位开始，依次从右往左填入上边格式中的x，多出的位补`0`。这样就得到了，严的 UTF-8 编码是`11100100 10111000 10100101`，转换成十六进制就是`E4 B8 A5`

## UTF-16

字符编码为双字节或者四字节

* 双字节编码方式与`Unicode`一样
* 四字节编码方式，每个部分各两个字节，其中，前面两个字节的前 6 位二进制固定为 `110110`，后面两个字节的前 6 位二进制固定为 `110111`, 前后部分各剩余 10 位二进制表示符号的 Unicode 码 减去 `0x10000` 的结果